<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:sail4oxygen"
             xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="sail4oxygen.Views.MainPage"
             NavigationPage.HasNavigationBar="False"
             Title="Research the Oceans"
             >
    <ContentPage.Behaviors>
        <mct:EventToCommandBehavior Command="{Binding AppearingCommand}" EventName="Appearing" />
    </ContentPage.Behaviors>

    <ContentPage.Resources>
        <Style x:Key="InvalidEntryStyle" TargetType="Entry">
            <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource s4ored}, Dark={StaticResource s4ored}}" />
        </Style>
        <Style x:Key="ValidEntryStyle" TargetType="Entry">
            <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}" />
        </Style>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout
            >
            <Grid ColumnDefinitions="*,70" RowDefinitions="*">
                <Button Grid.Column="1" Grid.Row="0"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Black}}"
                    TextColor="{AppThemeBinding Light={StaticResource s4blue100}, Dark={StaticResource Gray300}}"
                    Text="&#x24D8;"
                    FontSize="55"
                    Padding="0,6,0,0"
                    Margin="8,8,8,8"
                    HorizontalOptions="End"
                    Clicked="About_Clicked"
                    />

                <Label Grid.Column="0" Grid.Row="0"
                    TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                    Margin="24,24,0,0"
                    HorizontalOptions="Center"
                    HorizontalTextAlignment="Start"
                    Text="To upload your sample CSV-Data to GEOMAR Research Center in Kiel:"
                    FontSize="Medium" />
            </Grid>

            <Label
                TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                Margin="24,8,24,0"
                HorizontalOptions="Center"
                HorizontalTextAlignment="Start"
                TextType="Html"
                Text="1. Open the &lt;strong&gt;KOR-App&lt;/strong&gt; and import your measurement from a sonde. Than export the data to a CSV-file."
                FontSize="Small" />

            <Label
                TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                Margin="24,8,24,0"
                HorizontalOptions="Center"
                HorizontalTextAlignment="Start"
                TextType="Html"
                Text="2. Selecting &lt;strong&gt;sail4oxygen&lt;/strong&gt; from the share screen will bring you back here. &lt;strong&gt; You may want to adjust the coordinates&lt;/strong&gt; before &lt;strong&gt;Sending a CSV-File&lt;/strong&gt;."
                FontSize="Small" />

            <Label
                TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                Margin="24,8,24,0"
                HorizontalOptions="Center"
                HorizontalTextAlignment="Start"
                TextType="Html"
                Text="Your Mail-App will be launched automatically to transmit the data. (If you are prompted to select a File no CSV-File was shared from KOR-App.)"
                FontSize="Micro" />

            <BoxView
                HeightRequest="1"
                Margin="50,12,50,12"
                Color="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Gray300}}"
                />

            <HorizontalStackLayout
                VerticalOptions="Center"
                HorizontalOptions="Center"
                x:Name="CoordinateEditor"
                >
                <VerticalStackLayout>
                <Label
                    TextType="Html"
                    Text="Latitude &lt;em&gt;(xx,xxxxx)&lt;/em&gt;"
                    FontSize="Micro"
                    TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                    VerticalOptions="CenterAndExpand"/>
                <Entry
                    x:Name="LatitudeEntry"
                    Placeholder="Wait for Coordinate"
                    Text="{Binding MyLocation.Latitude , Mode=TwoWay, StringFormat='{0:00.00000}'}"
                    FontSize="Small"
                    VerticalOptions="CenterAndExpand">
                    <Entry.Behaviors>
                        <mct:TextValidationBehavior 
                            InvalidStyle="{StaticResource InvalidEntryStyle}"
                            ValidStyle="{StaticResource ValidEntryStyle}"
                            IsValid="{Binding LatitudeIsValid, Mode=TwoWay}"
                            Flags="ValidateOnValueChanged"
                            RegexPattern="(?:54(?:[\,\.]\d+)?|55(?:[\,\.]\d+)?)$"/>
                    </Entry.Behaviors>
                </Entry>
                <Label
                    TextType="Html"
                    Text="Longitude &lt;em&gt;(xxx,xxxxx)&lt;/em&gt;"
                    FontSize="Micro"
                    TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray300}}"
                    VerticalOptions="CenterAndExpand"/>
                <Entry
                    x:Name="LongitudeEntry"
                    Placeholder="Wait for Coordinate"
                    Text="{Binding MyLocation.Longitude , Mode=TwoWay, StringFormat='{0:000.00000}'}"
                    FontSize="Small"
                    VerticalOptions="CenterAndExpand">
                    <Entry.Behaviors>
                        <mct:TextValidationBehavior 
                            InvalidStyle="{StaticResource InvalidEntryStyle}"
                            IsValid="{Binding LongitudeIsValid, Mode=TwoWay}"
                            ValidStyle="{StaticResource ValidEntryStyle}"
                            Flags="ValidateOnValueChanged"
                            RegexPattern="(?:9(?:[\,\.]\d+)?|10(?:[\,\.]\d+)?)$"
                            />
                    </Entry.Behaviors>
                </Entry>
                </VerticalStackLayout>

                <Button
                    Text="Reload GPS"
                    Padding="8,8,8,8"
                    BackgroundColor="{AppThemeBinding Light={StaticResource s4blue100}, Dark={StaticResource s4blue25}}"
                    TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource s4blue100}}"
                    Margin="6,12,6,12"
                    SemanticProperties.Hint="Reloads Coordinates from GPS"
                    Clicked="OnGPSReload_Clicked"
                    HorizontalOptions="Center" />

            </HorizontalStackLayout>

            <HorizontalStackLayout>
            <Label
                TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
                Margin="55,25,0,11"
                HorizontalOptions="Start"
                HorizontalTextAlignment="Start"
                Text="{Binding FileName}"
                FontSize="Micro" />

            <Button
                Text="&#x24E7;"
                Padding="0,10,10,10"
                   BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Black}}"
                    TextColor="{AppThemeBinding Light={StaticResource s4blue100}, Dark={StaticResource Gray300}}"
                Margin="15,12,0,0"
                SemanticProperties.Hint="Selects a CSV File to send"
                Clicked="OnFileRemove_Clicked"
                HorizontalOptions="End"
                IsVisible="{Binding FileRemoveButtonVisible}"/>
            </HorizontalStackLayout>

            <Button
                Text="{Binding SendButtonText}"
                IsEnabled="{Binding CoordinatesValid}"
                Padding="50,25,50,25"
                BackgroundColor="{AppThemeBinding Light={StaticResource s4blue100}, Dark={StaticResource s4blue25}}"
                TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource s4blue100}}"
                Margin="0,8,0,20"
                SemanticProperties.Hint="Loads a CSV File and prepares a Mail to send"
                Clicked="OnCounterClicked"
                HorizontalOptions="Center" />

            <BoxView
                HeightRequest="1"
                Margin="50,12,50,24"
                Color="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Gray300}}"
                />

            <VerticalStackLayout
                VerticalOptions="FillAndExpand">
                <Label
                    Text="Citizen Science"
                    SemanticProperties.HeadingLevel="Level3"
                    FontSize="18"
                    HorizontalOptions="Center" />
                <Image
                    Source="s4ob.png"
                    SemanticProperties.Description="Sailing for Oxygen Logo"
                    HeightRequest="100"
                    VerticalOptions="Center"
                    HorizontalOptions="Center" />
            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>

</ContentPage>

